# 数据库设计

## 上链数据库设计

### 用户部分

#### 消费者账户表 user_account

| 名称            | 字段     | 字段备注    | 备注                | Null |
| --------------- | -------- | ----------- | ------------------- | ---- |
| accountId       | string   | varchar(50) | 消费者id，全局唯一  | N    |
| discountList    | string[] |             | 优惠卷id List       |      |
| commodityIdList | string[] |             | 所拥有的商品id List | N    |
| balance         | Int64    |             | 余额，单位：分      | N    |
| lastModified    | string   |             | 上次更新时间        | N    |

#### 商户账户表 bussiness_account

| 名称            | 字段     | 字段备注    | 备注               | Null |
| --------------- | -------- | ----------- | ------------------ | ---- |
| accountId       | string   | varchar(50) | 商户Id,全局唯一    | N    |
| commodityIdList | string[] |             | 商品Id List        | N    |
| balance         | Int64    |             | 余额，单位：分     | N    |
| discountList    | string[] |             | 商家所派发的优惠卷 | N    |
| lastModified    | string   |             | 上次更新时间       |      |

#### 商品表 commodity

| 名称        | 字段   | 字段备注    | 备注             | Null |
| ----------- | ------ | ----------- | ---------------- | ---- |
| commodityId | string | varchar(50) | 商品Id，全局唯一 | N    |
| name        | string | varchar(50) | 商品名称         | N    |
| price       | Int64  |             | 价格             |      |
| ownerId     | string | varchar(50) | 所属人id         | N    |
| time        | string |             | 上架日期，时间戳 | N    |

#### 交易表 trade

| 名称      | 字段   | 字段备注    | 备注             | Null |
| --------- | ------ | ----------- | ---------------- | ---- |
| tradeId   | string | varchar(50) | 交易Id,全局唯一  | N    |
| tradeTime | string |             | 交易时间，时间戳 | N    |
| buyerId   | string | varchar(50) | 买家id           | N    |
| salerId   | string | varchar(50) | 卖家id           |      |



#### 优惠卷表 discount

| 名称       | 字段   | 字段备注    | 备注                     | Null |
| ---------- | ------ | ----------- | ------------------------ | ---- |
| discountId | string | varchar(50) | 优惠卷id，全局唯一       | N    |
| name       | string | varchar(50) | 优惠卷名称               | N    |
| accountId  | string | varchar(50) | 该优惠卷所属账户Id       | N    |
| businessId | string | varchar(50) | 派发该优惠卷的商户的Id   | N    |
| beginTime  | string | varchar(50) | 开始有效时间，时间戳格式 | N    |
| endTime    | string | varchar(50) | 结束时间，时间戳格式     | N    |
| valid      | Bool   |             | 有效标识                 | N    |



## 链下数据库设计

### 用户部分

#### 用户 user

| 名称      | 字段   | 字段备注    | 备注                                         | Null |
| --------- | ------ | ----------- | -------------------------------------------- | ---- |
| userId    | string | varchar(50) | 消费者id，全局唯一                           | N    |
| userName  | string | varchar(50) | 用户名                                       | N    |
| userType  | string | varchar(4)  | 消费者类型<br>0:消费者<br>1:商家<br>其他待定 | N    |
| accountId | string | varchar(50) | 账户id                                       |      |
| phone     | string | varchar(50) | 电话号码                                     | N    |
| email     | string | varchar(50) | 邮箱账号                                     | N    |
| password  | string | varchar(50) | 密码，需加密                                 | N    |

